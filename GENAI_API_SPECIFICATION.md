
# GenAI FastAPI Backend API Specification for ClauseCraft

This document outlines the API endpoints and data structures that the ClauseCraft Next.js frontend expects from the GenAI FastAPI backend.

## 1. Process PDF and Generate Clauses

This endpoint is responsible for processing an entire PDF document, extracting clauses using an LLM, generating unique IDs for each clause, creating vector embeddings, and storing them in a vector database. It then returns the extracted clauses with their generated IDs.

*   **Endpoint:** `/process-pdf-and-generate-clauses`
*   **Method:** `POST`
*   **Request Body:**
    *   A JSON object with a single key, `pdf_url`, which is the public URL of the PDF document.

    ```json
    {
      "pdf_url": "https://example.com/path/to/your/document.pdf"
    }
    ```

*   **Expected Output:**
    *   A JSON array of `Clause` objects. Each clause object must include a `vector_id` (string) which is a unique identifier generated by the GenAI backend.

    ```json
    [
      {
        "vector_id": "uuid-123-abc",
        "clause_type": "Governing Law",
        "clause_text": "This Agreement shall be governed by and construed in accordance with the laws of the State of California."
      },
      {
        "vector_id": "uuid-456-def",
        "clause_type": "Confidentiality",
        "clause_text": "Each party agrees to keep confidential all information disclosed by the other party."
      }
    ]
    ```

*   **`Clause` Object Schema:**
    *   `vector_id` (string): A unique identifier for the clause, generated by the GenAI backend.
    *   `clause_type` (string): The heading or type of the clause, as identified by the LLM.
    *   `clause_text` (string): The full text of the clause, without the heading, as identified by the LLM.

## 2. Review Contract with LLM

This endpoint is the core of the review feature. It takes a PDF of a new contract, extracts its clauses, compares them to the playbook clauses in the vector DB, and generates suggestions.

*   **Endpoint:** `/review-contract-llm`
*   **Method:** `POST`
*   **Request Body:**
    *   A JSON object with a single key, `pdf_url`, which is the public URL of the PDF document to be reviewed.

    ```json
    {
      "pdf_url": "https://example.com/path/to/your/new-contract.pdf"
    }
    ```

*   **Expected Output:**
    *   A JSON array of `Suggestion` objects.

    ```json
    [
        {
            "clause_type": "Governing Law",
            "incoming_text": "This Agreement shall be governed by and construed in accordance with the laws of the State of California.",
            "suggestion": "Change the governing law from California to Delaware to align with company policy.",
            "severity": "Major",
            "rationale": "The company's standard playbook requires all contracts to be governed by the laws of the State of Delaware for consistency and legal predictability."
        },
        {
            "clause_type": "Confidentiality",
            "incoming_text": "Each party agrees to keep confidential all information disclosed by the other party.",
            "suggestion": "Consider adding a specific time limit for the confidentiality obligation.",
            "severity": "Minor",
            "rationale": "The current confidentiality clause is perpetual, which may be overly broad. A time limit of 3-5 years is standard for this type of agreement."
        }
    ]
    ```

*   **`Suggestion` Object Schema:**
    *   `clause_type` (string): The type of the clause being reviewed.
    *   `incoming_text` (string): The original text of the clause from the new contract.
    *   `suggestion` (string): The LLM-generated suggestion for how to improve the clause.
    *   `severity` (string): The severity of the issue, which should be one of "Minor", "Moderate", or "Major".
    *   `rationale` (string): The LLM-generated explanation for why the suggestion is being made.
